### David Ross Hall --- created on 2022-11-22

### Loose plots for thesis defence talk

```{r}
library(ggplot2)


# plot of DBP cancer data.
df <- readr::read_csv("data/hrudey_2009_waterResearch.csv")

colors <- c("#9381FF", "#FFB20F", "#FF0035")

ggplot(data = df,
       aes(x = ref,
           y = adj_or,
           ymin = ci_95_low,
           ymax = ci_95_high,
           colour = sex
       )) +
  geom_hline(yintercept = 1, size=1) +
  geom_errorbar(color = "black",
                width = 0.3) +
  geom_point(size=4) +
  facet_wrap(~sex, ncol = 1, scales = "free_y") +
  scale_color_manual(values = colors) +
  theme_classic() +
  theme(legend.position = "none",
        panel.background = element_rect(fill = "transparent"),
        plot.background = element_rect(fill = "transparent"),
        text = element_text(size = 10)
  ) +
  labs(y = "Odds Ratio (1.0 = no association)",
       x = "") +
  scale_y_continuous(trans = "log2",
                     breaks = c(0.5, 1, 2, 4, 8)) +
  coord_flip(ylim = c(0.5, 8))
```

```{r}
library(tidyverse)

tox <- read_csv("data/pcb77_bird_tox.csv")

p <- ggplot(data = tox,
       aes(x = dose,
           y = mortality,
           colour = species)) +
  geom_point(size = 3, alpha = 0.8) +
 #   scale_x_log10(
 #    breaks = scales::trans_breaks("log10", function(x) 10^x),
 #    labels = scales::trans_format("log10", scale::)
 #  #  labels = scales::label_number(scale_cut = scales::cut_long_scale())
 # ) +
  scale_x_log10() +
  annotation_logticks(sides = "b",
                      short = unit(.5,"mm"),
                      mid = unit(3,"mm"),
                      long = unit(4,"mm")
) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  labs(x = "PCB 77 Dose (ng/g)",
       y = "Avian Embryo Mortality ") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        text = element_text(size = 16) )

p2 <- p +
  geom_curve(
  aes(x =  4000, y = 19, xend = 5000, yend = 5),
  colour = "black",
  curvature = -0.15,
  arrow = arrow(length = unit(0.03, "npc"))
) +
  annotate("text", x = 4100, y = 25.5, hjust = 1, label = "Herring gull\n& Duck") +
  scale_colour_discrete(breaks=c("chicken", "pheasant", "turkey", "duck", "herring gull"))

p2
```

```{r, eval = FALSE}
ggsave(filename = "images/01-intro/pcb77_tox.png",
       plot = p2, 
       units = "in", 
       height = 4, 
       width = 6)
```

## Ahr binding plot

-   Karchner et al. PNAS 2009

```{r}
library(tidyverse)
# data extracted from Fig. 4D using webplot digitizer
ahr <- data.frame("variant" = c("Chicken", "Tern", "Tern T258A", "Tern V3251I", "Tern A381S"),
                  "ahr_binding" = c(100, 21, 16.5, 65.5, 81.0))


q <- ggplot(data = ahr, 
       aes(x = fct_reorder(variant, ahr_binding), 
           y = ahr_binding,
           colour = variant)) +
  # geom_bar(stat = "identity") +
  # geom_hline(yintercept=seq(25, 100, 25), col="white", lwd=1) +
  geom_segment(aes(x = fct_reorder(variant, ahr_binding), 
                   xend = fct_reorder(variant, ahr_binding),
                   y = 0, 
                   yend = ahr_binding),
               colour = "black") +
  geom_point(size=5) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  viridis::scale_color_viridis(discrete=TRUE) +
  theme_classic() +
  theme(legend.position = "none",
        text = element_text(size = 16)) +
  labs(x = "",
       y = "Percent Chicken AHR\nspecific binding") +
  coord_flip()
q

```
```{r}
q2 <- q +
    geom_curve(
  aes(x =  4000, y = 19, xend = 5000, yend = 5),
  colour = "black",
  curvature = -0.15,
  arrow = arrow(length = unit(0.03, "npc"))
) +
  annotate("text", x = 4100, y = 25.5, hjust = 1, label = "Herring gull\n& Duck") +
```
